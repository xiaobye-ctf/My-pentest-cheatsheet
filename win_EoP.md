# Windows EoP

## System
```bash
hostname
systeminfo

#Get more precise information
systeminfo | findstr /b /i /c:"os version" /c:"os name" /c:"system type"

#logical disk
wmic logicaldisk get Caption ,description ,providername
```
## Network
```bash
#network interface
ipconfig /all
#network service and established connection
netstat -ano
#route table
route print 
#arp table
arp -a
```
## User
```bash
whoami /all
net users
net localgroup
net user <username>
net localgroup <groupname>
```


## Process
```bash
tasklist /svc
```

## Service and scheduled task
```bash
#Scheduled task
schtasks /query /fo list /v

#Using wmic to get service list
wmic service get displayname,pathname
wmic service where Caption="service name" get name,caption,state,startmode

#Using powershell to get service list
Get-WmiObject win32_service | Select-Object Name,State,PathName|?{$_.State -like "Running"}

#stop service(need administrator permission)
net stop <service name>
```

## firewall 
```bash
#check if firewall open
netsh  advfirewall show currentprofile
#check the firewall rule
netsh advfirewall  firewall show rule name=all
```

## Installed application and patch level
```bash
#only list application that was installed by windows installer
wmic product get name ,version ,vendor
#Hot patched
wmic qfe get Caption,Description,HotFixId,InstalledOn
```

## file permission
```bash
icacls.exe <Pathname>
accesschk.exe -accepteula -uws "everyone" "C:\program files"
#If we can't transfer accesschk.exe to client or accesschk.exe doesn't work.
#This powershell command.
Get-ChildItem "C:\program files" -Recurse|Get-Acl|?{$_.AccessToString -match "Everyone\sAllow\s\sMo
dify"}
```

## Device and driver
```bash
#Device
mounvol
#Driver
driverquery.exe /v /fo csv|ConvertFrom-Csv|Select-Object 'Display Name' ,'Start Mode','Path'
#Driver
#This is powershell command
Get-WmiObject Win32_PnPSignedDriver|Select-Object DeviceName,DriverVersion,Manufacturer|?{$_.DeviceName -like "*VMware*"}
```

## specail trick
AlwaysInstallElevated
```bash
#if both value are 0x01,then we can craft .msi file to exploit it.
reg query HKCU\Software\Policies\Microsoft\Windows\Installer /v AlwaysInstallElvated
reg query HKLM\Software\Policies\Microsoft\Windows\Installer /v AlwaysInstallElvated
```

## automated enumeration
```bash
windows-privesc-check2.exe
```
